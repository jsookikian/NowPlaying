<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Using Results Databases</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="https://cloud.typography.com/7045754/7789972/css/fonts.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.next-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../../Resources/TableStyles/Standard.css" rel="stylesheet" />
        <link href="../../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js">
        </script>
        <script src="../../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="relative clearfix"><a class="logo" href="../../../../landing-page/gnsdk-home.htm" alt="Logo"></a>
                                    <div class="navigation-wrapper nocontent">
                                        <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="nav-search row outer-row">
                                <form class="search" action="#">
                                    <div class="search-bar search-bar-container needs-pie">
                                        <input class="search-field needs-pie" type="search" placeholder="Search" />
                                        <div class="search-filter-wrapper">
                                            <div class="search-filter">
                                                <div class="search-filter-content">
                                                    <ul>
                                                        <li>All Files</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="search-submit-wrapper" dir="ltr">
                                            <div class="search-submit" title="Search">
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row" data-mc-content-body="True">
                            <p style="font-weight: bold;"><span class="GeneralProductNameFull">GNSDK</span> <span class="GeneralAPI">C</span></p>
                            <p>Version 3.08.6.5437 : <span class="SystemShortDate">9/14/2017</span></p>
                            <hr width="100%" size="0" align="center" />
                            <div class="content">
                                <div id="contentBody">
                                    <div class="row collapse">
                                        <div class="sideContent">
                                            <div class="clearfix">
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie next-topic-button" title="Navigate next">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                        </button>
                                                        <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie print-button" title="Print">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/gnsdk__gnsdk_c.js" data-mc-side-menu="True" data-mc-max-depth="4" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            </ul>
                                        </div>
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <h1><a name="kanchor636"></a>Using Results Databases</h1>
                                        <p>GNSDK&#160;applications supports application created read/write databases for storing local and online query and image fetch results. These databases are referred to as <b>Results databases</b>  Results databases are similar to the off-the-shelf monthly production gdbs in that they have the same files and schema and are configured, enabled and opened in the same way. The main differences are that they are created by the application and are read-write. An application can have multiple Results databases open at one time, depending on the need of the application. These databases store results that can be returned in future queries.</p>
                                        <p>Results Databases: </p>
                                        <ul>
                                            <li value="1"><a name="kanchor637"></a>Support incremental Gracenote database updates that can eliminate the need to do a base replace of the entire database&#160;with the latest information. </li>
                                            <li value="2">Support deferred (or tethered)&#160;online searches when a user attempts a search without a connection.</li>
                                            <li value="3">Control disk space used by Gracenote databases.</li>
                                            <li value="4">Do not support record deletion or expiration. </li>
                                            <li value="5">Do not require the existence of a Gracenote delivered Production database in an application.</li>
                                        </ul>
                                        <h2>Application Flow</h2>
                                        <p>The process of using a Results database is similar to using any other GNSDK&#160;application. Each database must have a user supplied ID. This ID&#160;supports the use of a specific database. </p>
                                        <ol>
                                            <li value="1">Typically initialize the GNSDK, provide license information and create a user.</li>
                                            <li value="2">Open databases as necessary. Each database requires a unique ID and config_handle.</li>
                                            <li value="3"><a name="kanchor638"></a>Query and update as required.</li>
                                            <li value="4">Manage database sizes, as necessary. This might be needed only when data is added to a database.</li>
                                            <li value="5">Close databases and application.</li>
                                        </ol>
                                        <p>
                                            <h3>Managing Disk Space</h3>
                                            <p>The  Results database might need to be controlled to help maintain appropriate disk usage and content. If you are opening an existing Results database and intend to add to it,  checking disk usage is a good step to take immediately after adding information. In addition, you can't delete individual pieces of data from within a Results&#160;database, so if it is necessary to retire and purge old data, you must delete and recreate the entire database. The following snippet will check the size of a database, and if it is too large, it deletes it. </p>
                                            <p><pre class="prettyprint">/*&#160;Retrieve database size based on database ID */<br />gnsdk_lookupdatabase_size_get( db_identfier_id, &amp;size );

/*&#160;Check if DB&#160;size is larger than a pre-determined value.  If so,
   Remove old DB and start new one.  */
if (size &gt;&#160;MAX_DB_SIZE)&#160;
{
/*&#160;Close the database and delete it. */
   gnsdk_lookupdatabase_close( db_identifier_id );
   gnsdk_lookupdatabase_delete( config_handle );  
  
/*  code to reopen database here   */
...
}
</pre>
                                            </p>
                                        </p>
                                        <p>
                                            <h2>
                                                <h3>Querying and Updating a Results Database</h3>
                                            </h2>
                                        </p>
                                        <p>Whenever a query occurs, such as with <code class="prettyprint">gnsdk_musicid_query_find_matches()</code>, all open databases are searched. There are no specific functions for a specific Results database search. </p>
                                        <p>Gracenote Data Objects (GDOs) can be added to a Results database&#160;using the function <code class="prettyprint">gnsdk_lookupdatabase_record_add()</code>, and images can be added with<code class="prettyprint"> gnsdk_lookupdatabase_image_add()</code>. </p>
                                        <p>
                                            <p class="note" data-mc-autonum="&lt;b&gt;&lt;span style=&quot;color: #e31b23;&quot; class=&quot;mcFormatColor&quot;&gt;Note: &lt;/span&gt;&lt;/b&gt;"><span class="autonumber"><span><b><span style="color: #e31b23;" class="mcFormatColor">Note: </span></b></span></span>If the same result is found in more than one open database, the result with the higher revision will be returned. Also, while you can always add a query result to a Results database, if it is already present with a revision that is equal to or higher than that of the one you are adding, the add will not take place.</p>
                                        </p>
                                        <h2>Results Database Functions</h2>
                                        <p>The GNSDK&#160;provides several functions that allow you to open, read, write, or query databases. When making a database query, all open databases will be searched. &#160;You do not specify which database you wish to use. However, the API&#160;provides the following functions that allow you to use a specific database, based on the ID&#160;that you provided for it:</p>
                                        <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0">
                                            <col class="TableStyle-Standard-Column-Regular" />
                                            <col class="TableStyle-Standard-Column-Regular" />
                                            <thead>
                                                <tr class="TableStyle-Standard-Head-Header1">
                                                    <th class="TableStyle-Standard-HeadE-Regular-Header1">Function </th>
                                                    <th class="TableStyle-Standard-HeadD-Regular-Header1">Use</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_open()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Open local database set - database set is set of related Gracenote databases. This call will create new or open
  existing database set based on configuration given.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_close()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Close lookup local database - will wait if any threads have outstanding queries with this database.  
  If this API is not called, all open databases will be closed on gnsdk_manager_shutdown().</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_record_add()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Adds a record to the database.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_image_add()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Adds an image to the database.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_size_get()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Retrieves database size.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_delete()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1"><a name="kanchor639"></a>Deletes the local database files. 
  Only lookup related GDB files are deleted.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_validate()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Validates a database.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyB-Regular-Row1"><code class="prettyprint">gnsdk_lookupdatabase_info_get()</code>
                                                    </td>
                                                    <td class="TableStyle-Standard-BodyA-Regular-Row1">Retrieves database information that can be used for debugging purposes.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <p>.</p>
                                        <h2 class="example">Examples: Results Databases</h2>
                                        <p><a name="kanchor640"></a>Sample Application:&#160;musicid_automotive/main.c</p>
                                        <p>This application shows the intialization and shutdown of a GNSDK&#160;application, the opening of a Production database, and one Results&#160;database. It also shows database information lookup of the Results database, queries, and updates.</p>
                                        <p>Sample Application:&#160;musicid_persist_and_manage/main.c</p>
                                        <p>This more complex application shows the intialization and shutdown of a GNSDK&#160;application, the opening of a Production database, and two Results databases. In addition to queries and updates, it also shows size management of Results databases.</p>
                                    </div>
                                </div>
                            </div>
                            <hr width="100%" size="0" align="center" />
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>