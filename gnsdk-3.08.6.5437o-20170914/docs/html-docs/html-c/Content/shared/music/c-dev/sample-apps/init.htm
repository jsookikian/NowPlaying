<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Initialization</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="https://cloud.typography.com/7045754/7789972/css/fonts.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.next-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js">
        </script>
        <script src="../../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="relative clearfix"><a class="logo" href="../../../../landing-page/gnsdk-home.htm" alt="Logo"></a>
                                    <div class="navigation-wrapper nocontent">
                                        <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="nav-search row outer-row">
                                <form class="search" action="#">
                                    <div class="search-bar search-bar-container needs-pie">
                                        <input class="search-field needs-pie" type="search" placeholder="Search" />
                                        <div class="search-filter-wrapper">
                                            <div class="search-filter">
                                                <div class="search-filter-content">
                                                    <ul>
                                                        <li>All Files</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="search-submit-wrapper" dir="ltr">
                                            <div class="search-submit" title="Search">
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row" data-mc-content-body="True">
                            <p style="font-weight: bold;"><span class="GeneralProductNameFull">GNSDK</span> <span class="GeneralAPI">C</span></p>
                            <p>Version 3.08.6.5437 : <span class="SystemShortDate">9/14/2017</span></p>
                            <hr width="100%" size="0" align="center" />
                            <div class="content">
                                <div id="contentBody">
                                    <div class="row collapse">
                                        <div class="sideContent">
                                            <div class="clearfix">
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie next-topic-button" title="Navigate next">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                        </button>
                                                        <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie print-button" title="Print">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/gnsdk__gnsdk_c.js" data-mc-side-menu="True" data-mc-max-depth="4" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            </ul>
                                        </div>
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <h1>Initialization</h1>
                                        <p><a name="kanchor833"></a><a name="kanchor834"></a><a name="kanchor835"></a>After main() does some initial error checking on the Client ID, Client Tag and License File parameters, it calls _init_gnsdk() which makes a number of initialization calls.</p>
                                        <h2 class="Heading2"><a name="kanchor836"></a><a name="kanchor837"></a>Initialize the GNSDK Manager</h2>
                                        <p>Your application must initialize the GNSDK Manager prior to calling any other <span class="GeneralProductName">GNSDK</span><a name="kanchor838"></a> library. The GNSDK Manager is the central controller for your application's interaction with the Gracenote Service. The initialization call returns a GNSDK Manager handle for use in subsequent SDK calls, including any other initialization calls. This is a required call.</p><pre class="prettyprint">
/*
 *  Initialize the GNSDK Manager 
 */
gnsdk_manager_handle_t sdkmgr_handle= GNSDK_NULL;
gnsdk_manager_initialize(&amp;sdkmgr_handle, license_path, GNSDK_MANAGER_LICENSEDATA_FILENAME);
</pre>
                                        <p class="info">The GNSDK_MANAGER_LICENSEDATA_FILENAME define is passed for the parameter that is supposed to indicate the license string length but, instead, indicates that the license data should be read from a file.</p>
                                        <h2 class="Heading2">Enable SDK Logging</h2>
                                        <p>The sample application enables SDK logging in the _enable_logging() function. The sample application does not write to this log file, only the SDK. The log file this generates can help Gracenote in debugging your application. The _enable_logging() function makes the following GNSDK call:</p><pre class="prettyprint">gnsdk_manager_logging_enable(
/* Log file path */
"sample.log",
/* Include entries for all packages and subsystems */          
GNSDK_LOG_PKG_ALL,
/* Include only error and warning entries */        
GNSDK_LOG_LEVEL_ERROR|GNSDK_LOG_LEVEL_WARNING,
/* All logging options: timestamps, thread IDs, and so on. */  
GNSDK_LOG_OPTION_ALL,
/* Max size of log: 0 means a new log file is created each run */        
0,  
/* GNSDK_TRUE = old logs will be renamed and saved */          
GNSDK_FALSE          
);</pre>
                                        <h2 class="Heading2"><a name="kanchor839"></a><a name="kanchor840"></a><a name="kanchor841"></a>Initialize Storage and Local Lookup</h2>
                                        <p><a name="kanchor842"></a>To open a database you must first create a configuration for it. The configuration will set the path and the access mode to the database. The following snippet will set a configuration for a database, and configure it to support MusicID&#160;text queries and images:</p><pre class="prettyprint"><a name="kanchor843"></a>
gnsdk_cstr_t  db_identfier_id = "sampleDB_ID";
gnsdk_cstr_t  gracenote_db_path = "../../sampledb_path";
gnsdk_cstr_t  access_mode = GNSDK_LOOKUPDATABASE_ACCESS_READ_WRITE;
gnsdk_config_handle_t  config_handle   = GNSDK_NULL;

/* &#160;Error checking has been removed for brevity. Always check return codes from GNSDK&#160;functions.&#160;*/      

gnsdk_config_create(&amp;config_handle);
gnsdk_config_value_set(config_handle, GNSDK_CONFIG_LOOKUPDATABASE_ALL_LOCATION, gracenote_db_path);
gnsdk_config_value_set(config_handle, GNSDK_CONFIG_LOOKUPDATABASE_ACCESS, access_mode);

/* configure the database to support MusicID-Text queries and MusicID images */
gnsdk_config_value_set(config_handle, GNSDK_CONFIG_LOOKUPDATABASE_ENABLE_MUSICID_TEXT, GNSDK_VALUE_TRUE);
gnsdk_config_value_set(config_handle, GNSDK_CONFIG_LOOKUPDATABASE_ENABLE_MUSICID_IMAGES, GNSDK_VALUE_TRUE);      
</pre>
                                        <p>&#160;</p>
                                        <p>Once you have the configuration set, open the database, as shown in the following snippet:<br /><br /></p><pre class="prettyprint">
gnsdk_lookupdatabase_open(db_identfier_id, config_handle);
</pre>
                                        <h2 class="Heading2"> </h2>
                                        <h2 class="Heading2"><a name="kanchor844"></a>Initialize the MusicID Library Manager</h2>
                                        <p>Next, the application then initializes its interaction with the Gracenote MusicID library. Every <span class="GeneralProductName">GNSDK</span> library must be initialized before an application can successfully call any of its APIs.</p><pre class="prettyprint">
/*
 * Initialize the MusicID Library
 */
gnsdk_musicid_initialize(sdkmgr_handle);

</pre>
                                        <h2 class="Heading2"><a name="kanchor845"></a><a name="kanchor846"></a>Initialize the User Handle</h2>
                                        <p>Every application user is required to register with the Gracenote Service. To perform queries, an application must first register a new user and get its handle. A user represents an individual installation of a specific Client ID. This ensures that each application instance is receiving all required metadata entitlements. Users are represented in <span class="GeneralProductName">GNSDK</span> by their handles. These handles contain the client ID/Tag string. The _init_gdsdk() function calls _get_user_handle() to either create a new user handle or restore a user handle from serialized storage.</p>
                                        <p class="info">After your application creates a new user, it should save its handle to serialized storage, where it can be retrieved every time your application needs it to use again. If an application registers a new user on every use instead of storing a serialized user, then the user quota maintained for the Client ID is quickly exhausted. Once the quota is reached, attempting to create new users will fail. To maintain an accurate usage profile of your application, and to ensure that the services you are entitled to are not being used unintentionally, it is important that your application registers a new user only when needed, and then stores that user for future use.</p>
                                        <p>To register as a new user, your application can call gnsdk_manager_user_register(), then save the serialized user information in a file for future use.</p>
                                        <p>For user registration and serialization, your application uses the following two calls:</p>
                                        <ul>
                                            <li value="1"><strong>gnsdk_manager_user_register()</strong>—Registers the user and creates serialized data for storage and later retrieval.</li>
                                            <li value="2"><strong>gnsdk_manager_user_create()</strong>—Creates the user handle from the registered user.</li>
                                        </ul>
                                        <h3><a name="kanchor847"></a>Local-Only Registration</h3>
                                        <p>Your application has the option to register for 'local-only' queries with the following call:</p>
                                        <p><b>gnsdk_manager_user_register(GNSDK_USER_REGISTER_MODE_LOCALONLY)</b>
                                        </p>
                                        <p>In this case, the returned User object is not registered with the online service. A 'local-only' user can ONLY perform local queries and a failure will occur if an attempt is made to do an online query.</p>
                                        <p>If the above call, is followed with a <b>gnsdk_manager_user_set_autoregister()</b> call, then, when the SDK does its first only query with a 'local-only' user, online registration takes place and the User object is automatically updated. The resulting User object can then be subsequently used for both onine and local queries.</p>
                                        <h2 class="Heading2"><a name="kanchor848"></a>Initialize Localization</h2>
                                        <p>Finally, this sample application makes the following localization calls in the _set_locale() function. Note that these calls can be done at anytime, but must be done <i>after </i>user registration, since they require a user handle parameter.</p>
                                        <ul>
                                            <li value="1"><strong>gnsdk_manager_locale_load()</strong><a name="kanchor849"></a>—Sets locale and creates a locale handle for subsequent calls. GNSDK locales are identifiers to a specific set of lists in the Gracenote Service. By using a locale, an application instructs the Gracenote Service to return only the data contained in a specific list. A locale is defined by a language and (optionally) a list region, a list descriptor, and a group. this sample application sets language to English (GNSDK_LANG_ENGLISH) and the region to default (GNSDK_REGION_DEFAULT).</li>
                                            <li value="2"><strong>gnsdk_manager_locale_set_group_default()</strong>—Sets a locale's global group default; all GDOs will use this locale unless specifically overwritten by gnsdk_manager_gdo_set_locale(). If the default is not set, no locale-specific results would be available. The locale group was set in the local handle with the previous call when the GNSDK_LOCALE_GROUP_MUSIC was passed.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <hr width="100%" size="0" align="center" />
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>