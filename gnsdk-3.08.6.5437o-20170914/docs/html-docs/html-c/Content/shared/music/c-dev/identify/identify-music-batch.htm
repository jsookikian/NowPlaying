<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Identifying Music Using Batch Processing</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="https://cloud.typography.com/7045754/7789972/css/fonts.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.next-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../../Resources/TableStyles/Standard.css" rel="stylesheet" />
        <link href="../../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js">
        </script>
        <script src="../../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="relative clearfix"><a class="logo" href="../../../../landing-page/gnsdk-home.htm" alt="Logo"></a>
                                    <div class="navigation-wrapper nocontent">
                                        <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="nav-search row outer-row">
                                <form class="search" action="#">
                                    <div class="search-bar search-bar-container needs-pie">
                                        <input class="search-field needs-pie" type="search" placeholder="Search" />
                                        <div class="search-filter-wrapper">
                                            <div class="search-filter">
                                                <div class="search-filter-content">
                                                    <ul>
                                                        <li>All Files</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="search-submit-wrapper" dir="ltr">
                                            <div class="search-submit" title="Search">
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row" data-mc-content-body="True">
                            <p style="font-weight: bold;"><span class="GeneralProductNameFull">GNSDK</span> <span class="GeneralAPI">C</span></p>
                            <p>Version 3.08.6.5437 : <span class="SystemShortDate">9/14/2017</span></p>
                            <hr width="100%" size="0" align="center" />
                            <div class="content">
                                <div id="contentBody">
                                    <div class="row collapse">
                                        <div class="sideContent">
                                            <div class="clearfix">
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie next-topic-button" title="Navigate next">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                        </button>
                                                        <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie print-button" title="Print">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/gnsdk__gnsdk_c.js" data-mc-side-menu="True" data-mc-max-depth="4" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            </ul>
                                        </div>
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <h1><a name="kanchor315"></a><a name="kanchor316"></a>Identifying Music Using Batch Processing</h1>
                                        <p><a name="kanchor317"></a>Batch processing allows multiple queries to be performed in a single request to Gracenote Service. A single batch request can contain different query types, and each query can have different inputs. &#160;For example, a batch lookup can have a query for finding matches with text inputs in addition to finding matches based on fingerprint input.</p>
                                        <h2><a name="kanchor318"></a>Creating a Batch Query</h2>
                                        <p><a name="kanchor319"></a>You create queries the same way as any other&#160;MusicID&#160;query, but instead of invoking a find function on a single query, you add the query to a batch lookup handle, and then call a batch execute function. Each query requires a unique string identifier. The identifier allows the application to associate the query with its results. Creating a batch query with an identifier already in use results in an error. Gracenote recommends batches between 20 and 50 queries. &#160;In creating your batch queries please note the following:</p>
                                        <ul>
                                            <li value="1">Batches containing 20 queries offer a measurable reduction in average query processing time as well as uplink and downlink transmission size without much of an increase to peak memory usage.</li>
                                            <li value="2">Batches containing approximately 50 queries offers some reduction in average query processing time as well as uplink and downlink data transmissions, but the peak memory usage is higher.</li>
                                            <li value="3">Batches greater than 50 queries often increases average query processing time as well as uplink and downlink data transmissions and require larger peak memory usage.</li>
                                            <li value="4">Batch sizes of one are discouraged. It is more efficient to use a standard query if only one result is required.</li>
                                        </ul>
                                        <p> The following example creates an array of 5 text queries, and then calls the batch function <code class="prettyprint">gnsdk_musicid_batch_query_create()</code> to create the query, and <code class="prettyprint">gnsdk_musicid_batch_query_set_text()</code> to set query text:</p>
                                        <p class="code"><pre class="prettyprint"><a name="kanchor320"></a><a name="kanchor321"></a><a name="kanchor322"></a>
/* 
 NOTE: Return code checking has been removed for brevity.  Always check GNSDK return codes.
 Create the batch query handle. 
*/
gnsdk_musicid_batch_create( 
    user_handle,     /*&#160;From program initialization */
    GNSDK_NULL,      /* User callback function */
    GNSDK_NULL,      /* Optional data to be passed to the callback */
    &amp;batch_handle    /* Batch handle returned */
);
        
/* 
   Add queries to the batch query handle. This section of code adds queries based on the batch handle,
   and within that handle, on the unique name of the individual query.            
*/      
/* create individual queries for the batch handle, each query must have a unique identifier */
/* Track 1 */
gnsdk_musicid_batch_query_create(batch_handle, "track_1");
gnsdk_musicid_batch_query_set_text(batch_handle, "track_1", GNSDK_MUSICID_FIELD_TRACK_ARTIST, "Jesse Cook");
gnsdk_musicid_batch_query_set_text(batch_handle, "track_1", GNSDK_MUSICID_FIELD_ALBUM, "Ultimate Jesse Cook (Disc 2)");
gnsdk_musicid_batch_query_set_text(batch_handle, "track_1", GNSDK_MUSICID_FIELD_TITLE, "On Walks The Night");

/* Track 2 */
gnsdk_musicid_batch_query_create(batch_handle, "track_2");
gnsdk_musicid_batch_query_set_text(batch_handle, "track_2", GNSDK_MUSICID_FIELD_TRACK_ARTIST, "The Cure");
gnsdk_musicid_batch_query_set_text(batch_handle, "track_2", GNSDK_MUSICID_FIELD_ALBUM, "Join The Dots: B-Sides and Rarities 1978-2001 (Box Set CD 1)");
gnsdk_musicid_batch_query_set_text(batch_handle, "track_2", GNSDK_MUSICID_FIELD_TITLE, "A Man Inside My Mouth");

/* additional queries can be created based on other inputs such as CD TOC, fingerprint and identifier.*/

</pre>
                                        </p>
                                        <h2>Performing a Batch Query and Retrieving Data</h2>
                                        <p>After the batch query is set, you retrieve the results from all queries with one call to <code class="prettyprint">gnsdk_musicid_batch_find_matches()</code>or<code class="prettyprint"> gnsdk_musicid_batch_find_albums()</code>. The individual queries are executed in one request to Gracenote Service.You retrieve the responses from the batch handle using <code class="prettyprint">gnsdk_musicid_batch_response_get()</code>, based on the unique identifier for the query. Queries executed in batch are limited to a single response. Because of this, <code class="prettyprint">GNSDK_MUSICID_OPTION_RESULT_SINGLE</code>&#160;is automatically set and cannot be unset. The following code executes the batch query based on the queries in the previous snippet, and retrieves the individual response GDOs: It then releases the batch query handle:</p>
                                        <p class="code"><pre class="prettyprint">
/* Perform batch query using the batch query handle. */
gnsdk_musicid_batch_find_matches(batch_handle);  

/* 
   At this point all responses have been created with one call to the database.  You can now retrieve response GDO data 
   based on the unique query id.
*/

/* Track 1 */
gnsdk_musicid_batch_response_get(batch_handle, "track_1", &amp;response_gdo);
/* process Track 1 response */


/* Track 2 */
gnsdk_musicid_batch_response_get(batch_handle, "track_2", &amp;response_gdo);
/* process Track 1 response */

        
/* 
   After you have completed processing, release any query handles or GDOs as required. 
   Following completion of batch queries, you must also release the batch query handle.        
*/        
gnsdk_musicid_batch_release(batch_handle);
                
            </pre>
                                        </p>
                                        <h2>Setting Batch Lookup Options</h2>
                                        <p>Options set on a batch lookup affect all queries added to the batch lookup handle. Options are the same for batch queries as for non-batched queries.&#160;&#160;The following code sets the lookup mode for the batch queries to online nocache mode.</p>
                                        <p class="code"><pre class="prettyprint"><a name="kanchor323"></a><a name="kanchor324"></a>
/* Set option for online lookup */        
gnsdk_musicid_batch_option_set(batch_handle, GNSDK_MUSICID_OPTION_LOOKUP_MODE, GNSDK_LOOKUP_MODE_ONLINE_NOCACHE);        </pre>
                                        </p>
                                        <h2>Examining Batch Functions</h2>
                                        <p>The following table contains the listing of batch query functions available. &#160;Consult gnsdk_musicd.h for further information.</p>
                                        <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/Standard.css');" class="TableStyle-Standard" cellspacing="0">
                                            <col class="TableStyle-Standard-Column-Regular" />
                                            <col class="TableStyle-Standard-Column-Regular" />
                                            <thead>
                                                <tr class="TableStyle-Standard-Head-Header1">
                                                    <th class="TableStyle-Standard-HeadE-Regular-Header1">Function Name</th>
                                                    <th class="TableStyle-Standard-HeadD-Regular-Header1">Description</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_clear()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Removes all individual queries from a MusicID batch query.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_create()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Creates a MusicID batch query handle.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_find_albums()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Performs a MusicID batch query for album results.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_find_matches()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Performs a MusicID batch query for matches of the best fit type (albums or contributors).</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_option_get()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1"> Retrieves an option for a given MusicID batch query handle.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_option_set()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Sets an option for a given MusicID batch query handle. Options set on the batch handle
 apply to individual queries processed in the batch.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_query_add_toc_offset()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Sets CD TOC offset values for an individual query.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_query_create()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Creates a new individual query to be processed as part of the MusicID batch query.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_query_set_fp_data()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Sets externally-generated fingerprint data for an individual query.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_query_set_gdo()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Sets GDO input for an individual query.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_query_set_text()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Sets text inputs for an individual query.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_query_set_toc_string()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Sets CD TOC input for an individual query.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_release()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Invalidates and releases resources for a given MusicID batch query handle.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyE-Regular-Row1">gnsdk_musicid_batch_response_get()</td>
                                                    <td class="TableStyle-Standard-BodyD-Regular-Row1">Gets an individual query's response from a batch query using it's unique identifier.</td>
                                                </tr>
                                                <tr class="TableStyle-Standard-Body-Row1">
                                                    <td class="TableStyle-Standard-BodyB-Regular-Row1">gnsdk_musicid_batch_set_locale()</td>
                                                    <td class="TableStyle-Standard-BodyA-Regular-Row1">Sets a locale to be used as input for all queries added to a MusicID batch query.</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <h2 class="example">Example:&#160;Executing Batch Lookups</h2>
                                        <p data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt"><a name="kanchor325"></a>Sample Application: musicid_lookup_batch_matches_text/main.c</p>
                                        <p data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Application Steps:</p>
                                        <ol>
                                            <li value="1" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt"><a name="kanchor326"></a><a name="kanchor327"></a>Authenticate User and initialize Manager and other modules as necessary.</li>
                                            <li value="2" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Create two batch query arrays.</li>
                                            <li value="3" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Perform the batch queries and trace through response GDOs for results.</li>
                                            <li value="4" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Release resources and shutdown GNSDK and modules.</li>
                                        </ol>
                                        <p data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">&#160;</p>
                                    </div>
                                </div>
                            </div>
                            <hr width="100%" size="0" align="center" />
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>