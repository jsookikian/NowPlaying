<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_HTML5___Top_Navigation" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../../../" data-mc-has-content-body="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="non-print" data-mc-toc-path="[%=System.LinkedTitle%]|[%=System.LinkedTitle%]">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Identifying Streaming Music</title>
        <link href="../../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="https://cloud.typography.com/7045754/7789972/css/fonts.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.next-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-next.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.previous-topic-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/navigate-previous.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.remove-highlight-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/highlight.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.expand-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/expand.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.separator-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.print-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/printer.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.button.collapse-all-button
{
	-pie-background: url('../../../../../Skins/Default/Stylesheets/Images/collapse.png') no-repeat center center, linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../../Resources/Stylesheets/MainStyles.css" rel="stylesheet" />
        <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js">
        </script>
        <script src="../../../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="relative clearfix"><a class="logo" href="../../../../landing-page/gnsdk-home.htm" alt="Logo"></a>
                                    <div class="navigation-wrapper nocontent">
                                        <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="nav-search row outer-row">
                                <form class="search" action="#">
                                    <div class="search-bar search-bar-container needs-pie">
                                        <input class="search-field needs-pie" type="search" placeholder="Search" />
                                        <div class="search-filter-wrapper">
                                            <div class="search-filter">
                                                <div class="search-filter-content">
                                                    <ul>
                                                        <li>All Files</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="search-submit-wrapper" dir="ltr">
                                            <div class="search-submit" title="Search">
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row" data-mc-content-body="True">
                            <p style="font-weight: bold;"><span class="GeneralProductNameFull">GNSDK</span> <span class="GeneralAPI">C</span></p>
                            <p>Version 3.08.6.5437 : <span class="SystemShortDate">9/14/2017</span></p>
                            <hr width="100%" size="0" align="center" />
                            <div class="content">
                                <div id="contentBody">
                                    <div class="row collapse">
                                        <div class="sideContent">
                                            <div class="clearfix">
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_TopicToolBar mc-component nocontent">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie next-topic-button" title="Navigate next">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="next topic" />
                                                        </button>
                                                        <button class="button needs-pie previous-topic-button" title="Navigate previous">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="previous topic" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie remove-highlight-button" title="Remove Highlights">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="remove highlight" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                        <div class="button-separator">
                                                        </div>
                                                        <button class="button needs-pie print-button" title="Print">
                                                            <img src="../../../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="print" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <ul class="nocontent menu _Skins_SideMenu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/Tocs/gnsdk__gnsdk_c.js" data-mc-side-menu="True" data-mc-max-depth="4" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                            </ul>
                                        </div>
                                        <div class="nocontent">
                                            <div class="MCBreadcrumbsBox_0 breadcrumbs" data-mc-breadcrumbs-divider=" &gt; " data-mc-breadcrumbs-count="3" data-mc-toc="True"><span class="MCBreadcrumbsPrefix">You are here: </span>
                                            </div>
                                        </div>
                                        <h1><a name="kanchor596"></a>Identifying Streaming Music</h1>
                                        <p>The functionality for identifying streaming music is contained in the library <code class="prettyprint">gnsdk_musicid_stream</code>.   </p>
                                        <p>In general, identification requires up to seven seconds of audio. If there is not enough audio available to make the identification, the system waits until enough audio is received.
The identification process triggers callbacks and completes asynchronously. 
</p>
                                        <p>You can cancel the identification process outside of a callback using  <code class="prettyprint">gnsdk_musicidstream_channel_identify_cancel()</code>. Canceling calls the identify error delegate method with an "aborted" error . Canceling does not stop audio processing. Your application can restart the identification process after canceling.</p>
                                        <p>When canceling a user-initiated query, a result may have already been returned internally. Your application can decide whether or not to show this result to the user.</p>
                                        <h2 data-mc-conditions="Default.desk-gen-cndt,Default.acr-gen-cndt,Default.mobl-gen-cndt,Default.vacr-gen-cndt"><a name="kanchor597"></a>MusicID Stream Callbacks</h2>
                                        <p data-mc-conditions="Default.desk-gen-cndt,Default.acr-gen-cndt,Default.mobl-gen-cndt,Default.vacr-gen-cndt">MusicID Stream requires callbacks to receive identification results. When MusicID Stream receives enough audio, it will perform the identification and send the result back to the appropriate callback. The callbacks are set when creating the channel:<br /></p><pre class="prettyprint">
/*&#160;Declare variables for callbacks and resulting channel */  
gnsdk_musicidstream_channel_handle_t channel_handle = GNSDK_NULL;
gnsdk_musicidstream_callbacks_t    callbacks    = {0};
gnsdk_error_t            error      = GNSDK_SUCCESS;
int                  rc       = 0;

/*&#160;Set necessary callbacks for the application.  */
callbacks.callback_status       = GNSDK_NULL; 
callbacks.callback_processing_status  = GNSDK_NULL; 
callbacks.callback_identifying_status = 
   _musicidstream_identifying_status_callback;
callbacks.callback_result_available   = 
   _musicidstream_result_available_callback;
callbacks.callback_error        = 
   _musicidstream_completed_with_error_callback;

/* Create the channel handle */
error = gnsdk_musicidstream_channel_create(
  user_handle,
  gnsdk_musicidstream_preset_radio,
  &amp;callbacks,      
  GNSDK_NULL,    
    &amp;channel_handle
    );
    </pre>
                                        <p>Once you have created your channel handle, you read in the data from your source, and write it out.<br /></p><pre class="prettyprint">
/* Give audio data information for the channel */
error = gnsdk_musicidstream_channel_audio_begin(
  channel_handle, 44100, 16, 2 );

/* Launch the identification request */
error = gnsdk_musicidstream_channel_identify(channel_handle);

/* Read in data and process */
...
/* write audio to the fingerprinter */
error = gnsdk_musicidstream_channel_audio_write(
  channel_handle,  pcm_audio, read_size);
...
/* When we are done, end the stream */  
error = gnsdk_musicidstream_channel_audio_end(channel_handle);


/* Wait for the identification to finish so we actually get results */
gnsdk_musicidstream_channel_wait_for_identify(channel_handle, GNSDK_MUSICIDSTREAM_TIMEOUT_INFINITE);
      
/* Close the channel. */  
gnsdk_musicidstream_channel_release(channel_handle);                
</pre>
                                        <h2 class="example" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Example: Identifying Streaming Music</h2>
                                        <p data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt"><a name="kanchor598"></a>Sample Application: musicid_stream_manual/main.c</p>
                                        <p data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Application Steps:</p>
                                        <ol>
                                            <li value="1" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt"><a name="kanchor599"></a><a name="kanchor600"></a><a name="kanchor601"></a><a name="kanchor602"></a>Authenticate User and initialize Manager, SQlite, LocalStream, DSP, MusicID, and other modules as necessary.</li>
                                            <li value="2" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Create a Music-ID Stream channel and write audio.</li>
                                            <li value="3" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Perform identification and display results.</li>
                                            <li value="4" data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">Release resources and shutdown GNSDK and modules.</li>
                                        </ol>
                                        <p data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt">This application reads data from a .wav file and includes examples of necessary callbacks.</p>
                                        <p data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt"><b>Sample output:</b>
                                        </p><pre data-mc-conditions="Default.vacr-gen-cndt,Default.acr-gen-cndt,Default.desk-gen-cndt,Default.mobl-gen-cndt"><a name="kanchor603"></a><a name="kanchor604"></a><a name="kanchor605"></a><a name="kanchor606"></a>GNSDK Product Version  : v3.05.0.721   (built 2013-04-02 22:29-0700)

*****Sample MID-Stream Query*****
  Match count: 2
      Title: A Ghost is Born
      Title: Mensajes
  Final album:
      Title: A Ghost is Born   </pre>
                                    </div>
                                </div>
                            </div>
                            <hr width="100%" size="0" align="center" />
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>